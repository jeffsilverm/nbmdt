<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<title>Network Boot Monitor Diagnostic Tool (NBMDT)</title>
</head><body style=" color: rgb(0, 0, 0); background-color: rgb(204, 204, 204);" vlink="#FF0000" alink="#000088" link="#0000FF">
<h1><a name="mozTocId568287" class="mozTocH1"></a>Requirements for the Network Boot Diagnostic and Monitoring Tool (NBMDT)</h1>

<p>This page lays out the requirements for the NBMDT.&nbsp; The NBMDT is a python program that</p>

<ol>

  <li>Verifies that the network is working properly at system boot time<br>
  </li>
  <li>Diagnosis problems in the network by comparing a known good state of the network with the current state of the network</li>
  <li>Monitors the network to verify that it is working properly.</li>
</ol>

<p>There is user documentation (which as of this writing, also has developer information that should be separated out) at <a href="The_Network_Boot_Monitor_Diagnostic_Tool.html">The_Network_Boot_Monitor_Diagnostic_Tool.html</a></p>

<p><br>
</p>

<h2><a name="mozTocId320689" class="mozTocH2"></a>Table of contents</h2>

<ol id="mozToc">

<!--mozToc h1 1 h2 2 h3 3 h4 4 h5 5 h6 6--><li><a href="#mozTocId568287">Requirements for the Network Boot Diagnostic and Monitoring Tool (NBMDT)</a><ol><li><a href="#mozTocId320689">Table of contents</a></li><li><a href="#mozTocId954355">Requirements</a><ol><li><a href="#mozTocId63074">Dependencies</a></li><li><a href="#mozTocId314080">Errors</a></li><li><a href="#mozTocId185204" style="">Execution environments</a><ol><li><a href="#mozTocId951070">Platforms</a></li><li><a href="#mozTocId508795">Terminal software</a></li><li><a href="#mozTocId730933">python software</a></li></ol></li><li><a href="#mozTocId156608">User Interfaces</a></li></ol></li></ol></li><li><a href="#mozTocId192195">Testing procedures</a></li><li><a href="#mozTocId174413">Acronyms</a></li>
</ol>

<p><br>
</p>

<h2><a name="mozTocId954355" class="mozTocH2"></a>Requirements</h2>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in
      <a href="https://www.ietf.org/rfc/rfc2119.txt">RFC 2119</a>.</p>

<p>The NBMDT shall test the following components:</p>

<ul>

  <li>Ethernet</li>
  <li>WiFi</li>
  <li>ARP</li>
  <li>NDS</li>
  <li>IPv4</li>
  <li>IPv6</li>
  <li>DNS</li>
  <li>NTP</li>
  <li>A list of applications that run on this machine and use resources across the network<br>
  </li>
  <li>A list of services that run on this machine that resources across the network may use</li>
</ul>

<p>The NBMDT may test additional components.</p>

<p>The implementer shall document which of these requirements are met in each release.</p>

<p>The NBMDT is "test" software, in that it tests a network.&nbsp; 
However, the NBMDT itself must also be tested, just as any other 
software is tested.&nbsp; The t<a href="mozTocId192195">est procedures section below</a> describes how the NBMDT tests networks.<br>
</p>


<h3><a name="mozTocId63074" class="mozTocH3"></a>Dependencies<br>
</h3>

<p>The NBMDT understands dependencies.&nbsp; The NBMDT shall 
differentiate between a component that fails because a component it 
depends on has failed and a component that has failed for an unknown 
reason.&nbsp; The NBMDT should do as much as it can to diagnose the 
problem.<br>
</p>

<ol>

  <li>All client applications depend on DNS.</li>
  <li>Some client applications depend on NTP</li>
  <li>Every client application depends on remote servers.&nbsp; It is 
not practical to test all remote servers, so one of the configuration 
items shall be a list of servers to test and a procedure for testing 
them.&nbsp; Tests developed for nagios may be used here.<br>
  </li>
  <li>All Applications also depend on TCP or UDP (other transport protocols, such as SCTP, are possible)</li>
  <li>DNS depends on UDP and might depend on TCP.&nbsp; A list of 
optional remote name servers should be a configuration item.&nbsp; nbmdt
 may develop a list of remote name servers by inspecting 
/etc/resolve.conf on UNIX systems and TBD on MS-Windows.&nbsp; It must 
be a configuration error if nbmdt is unable to develop a list of at 
least one remote name server.</li>
  <li>Some systems depend on remote authentication, i.e. AD, Kerberos, NIS.</li>
  <li>Kerberos depends on NTP.&nbsp; Does AD?&nbsp; Does NIS?<br>
  </li>
  <li>NTP depends on UDP.&nbsp; <br>
  </li>
  <li>TCP depends on either IPv4 or IPv6 but preferably both</li>
  <li>UDP depends on either IPv4 or IPv6 but preferably both</li>
  <li>IPv6 routing depends on IPv6 on all interfaces it is enabled for</li>
  <li>IPv4 routing depends on IPv4 on all interfaces it is enabled for</li>
  <li>IPv4 depends on ethernet or WiFi or both (Other media are possible)</li>
  <li>IPv4 on Ethernet or Wifi (or other 802.x media) depend on ARP</li>
  <li>IPv6 depends on NDP</li>
  <li>IPv4 depends on the default router.&nbsp; It must be a <a href="file:///home/jeffs/nbmdt/Network%20Boot%20Monitor%20Diagnostic%20Tool%20%28NBMDT%29.html#CONFIGURATION_ERROR">configuration error</a> if the NBMDT cannot identify a default IPv4 router.<br>
  </li>
  <li>IPv6 depends on the default router.&nbsp; It should be a <a href="#CONFIGURATION_ERROR">configuration error</a> if the NBMDT cannot identify a default IPv6 router.</li>
  <li>IPv4 might depend on DHCP or it might be configured through a 
file.&nbsp; The NBMDT shall identify how IPv4 is configured and shall 
verify that the configuration is reasonable</li>
  <li>IPv6 might depend on DHCP6, or through NDP, or it might be 
configured through a file.&nbsp;
 The NBMDT shall identify how IPv6 is configured and shall verify that 
the configuration is reasonable.&nbsp; If the IPv6 configuration changes
 because of a change in router configuration that has propagated through
 NDS, then the NBMDT shall indicate an <a href="#UNEXPECTED_CONFIGURATION_CHANGE">UNEXPECTED CONFIGURATION CHANGE</a>.<br>
  </li>
  <li>IPv4 depends on <a href="#ARP">ARP</a></li>
  <li>IPv6 depends on <a href="#NDP">NDP</a>.<br>
  </li>
  <li>ARP depends on Ethernet or WiFi</li>
  <li>NDP depends on Ethernet or WiFi</li>
  <li>WiFi depends on its <a href="#AP">AP</a><br>
  </li>
  <li>Ethernet adapter must be UP, and packet counters must be increasing</li>
  <li>At least one Ethernet or WiFi adapter must have an IPv4 address (really?)</li>
  <li>At least one Ethernet or WiFi adapter must have either a global unicast IPv6 or a unique local IPv6 address</li>
  <li>If an Ethernet adapter has no carrier, then its IPv4 and IPv6 
addresses need not be defined. If the addresses are not defined in this 
case, then NBMDT shall indicate a <a href="#DEPENDENCY_FAILURE">DEPENDENCY FAILURE</a>.<br>
  </li>
  <li>WiFi adapter must be connected, and packet counters must be increasing.<br>
  </li>
</ol>

<h3><a name="mozTocId314080" class="mozTocH3"></a>Errors<br>
</h3>

<p>NBMDT has the following error conditions (in order of increasing severity):</p>

<ol>

  <li><a name="NORMAL"></a>NORMAL</li>
  <li><a name="UNEXPECTED_CONFIGURATION_CHANGE"></a>UNEXPECTED 
CONFIGURATION CHANGE - The network is still working, but something has 
changed.&nbsp; For example, DHCP might have handed out a new IPv4 
address, the default nameservers might have changed, or the WiFi SSD 
might be new.<br>
  </li>
  <li>DEGRADED_REDUNDANT due to a loss of a redundant dependency (e.g. one of several name servers has failed)</li>
  <li><a name="DEGRADED_PERFORMANCE"></a>DEGRADED_PERFORMANCE&nbsp; loss of performance (e.g. excess round trip times, packet loss)</li>
  <li>FAILURE ACKNOWLEDGED an error was reported to the operator, and he or she has acknowledged it</li>
  <li><a name="DEPENDENCY_FAILURE"></a>DEPENDENCY FAILURE something that this component depends on has failed</li>
  <li><a name="FAILURE"></a>FAILURE This component is down, cause is unknown, but not due to something that this component depends on.</li>
  <li><a name="CONFIGURATION_ERROR"></a>CONFIGURATION ERROR NBMDT is 
unable to figure out something important on its own, and that 
configuration item is not in the configuration file. Syntax errors in 
the configuration file.</li>
</ol>

<h3><a name="mozTocId185204" class="mozTocH3"></a>Execution environments<br>
</h3>

<h4><a name="mozTocId951070" class="mozTocH4"></a>Platforms</h4>

<p>The nbmdt shall be tested on the following platforms:</p>

<ul>

  <li>Linux</li>
  <ul>
    <li>Debian based</li>
    <li>redhat based</li>
  </ul>
  <li>Mac OS X</li>
  <li>MS-Windows</li>
  <ul>
    <li>Windows/10</li>
    <li>Windows Server</li>
  </ul>
  <li>Rasperry PI</li>
</ul>

<h4><a name="mozTocId508795" class="mozTocH4"></a>Terminal software<br>
</h4>

<p>The nbmdt shall run on the following terminal software:</p>

<ul>

  <li>Windows:</li>
  <ul>
    <li>putty</li>
    <li>command.exe</li>
    <li>power shell</li>
    <li>Native python<br>
    </li>
  </ul>
  <li>Linux</li>
  <ul>
    <li>gnome-terminal</li>
    <li>mate-terminal</li>
    <li>kde-terminal</li>
  </ul>
  <li>Mac OS X</li>
  <ul>
    <li>terminal</li>
    <li>tmux</li>
  </ul>
  <li>Rasberry PI</li>
  <ul>
    <li>TBD<br>
    </li>
  </ul>
</ul>

<h4><a name="mozTocId730933" class="mozTocH4"></a>python software<br>
</h4>

<p>The nbmdt shall run under Python 3.6.&nbsp; It should run under Python 3.7.</p>

<h3><a name="mozTocId156608" class="mozTocH3"></a>User Interfaces</h3>

<p>The nbmdt shall provide the following user interfaces:</p>

<ul>

  <li>A CLI suitable for scripting</li>
  <li>A terminal graphical interface that uses ANSI X3.64 escape characters and commonly used terminal extensions as described above.</li>
  <li>A GUI using python graphical interface libraries such as tkinter</li>
  <li>A web user interface suitable for use with a browser</li>
</ul>

<p><br>
</p>

<h1><a name="mozTocId192195" class="mozTocH1"></a>Testing procedures</h1>

<p>The NBMDT shall test the network starting at the lowest levels of the OSI model and work upwards.</p>

<p>The nbmdt shall itself be tested using these tests in simulation, as described in the <a href="nbmdt_test_plan.html">test plan</a>.<br>
</p>


<p><br>
</p>

<h2>Rough draft of testing procedures</h2>

<p>The section describes how the NBMDT tests networks<br>
</p>


<h3>linux - ethernet</h3>
<p>See the <a href="nbmdt_test_plan.html#mozTocId338377">test plan linux ethernet section</a>.<br>
</p>


<p>There is a response in <a href="https://stackoverflow.com/questions/36715664/using-ip-what-does-lower-up-mean" style="">stackoverflow</a> that says:<br>
</p>

<p><meta http-equiv="content-type" content="text/html; charset=UTF-8"></p>

<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; line-height: inherit; font-family: Arial, &quot;Helvetica Neue&quot;, Helvetica, sans-serif; font-size: 15px; vertical-align: baseline; box-sizing: inherit; clear: both; color: rgb(36, 39, 41); letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><code style="margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: Consolas, Menlo, Monaco, &quot;Lucida Console&quot;, &quot;Liberation Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, monospace, sans-serif; font-size: 13px; vertical-align: baseline; box-sizing: inherit; background-color: rgb(239, 240, 241); white-space: pre-wrap;">LOWER_UP</code><span>&nbsp;</span>is a physical layer link flag (the layer below the network layer, where<span>&nbsp;</span><code style="margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: Consolas, Menlo, Monaco, &quot;Lucida Console&quot;, &quot;Liberation Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, monospace, sans-serif; font-size: 13px; vertical-align: baseline; box-sizing: inherit; background-color: rgb(239, 240, 241); white-space: pre-wrap;">IP</code><span>&nbsp;</span>is generally located).<span>&nbsp;</span><code style="margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: Consolas, Menlo, Monaco, &quot;Lucida Console&quot;, &quot;Liberation Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, monospace, sans-serif; font-size: 13px; vertical-align: baseline; box-sizing: inherit; background-color: rgb(239, 240, 241); white-space: pre-wrap;">LOWER_UP</code><span>&nbsp;</span>indicates that an Ethernet cable was plugged in and that the device is connected to the network.</p>

<p style="margin: 0px 0px 1em; padding: 0px; border: 0px; font-style: normal; font-variant-ligatures: normal; font-variant-caps: normal; font-variant-numeric: inherit; font-variant-east-asian: inherit; font-weight: 400; font-stretch: inherit; line-height: inherit; font-family: Arial, &quot;Helvetica Neue&quot;, Helvetica, sans-serif; font-size: 15px; vertical-align: baseline; box-sizing: inherit; clear: both; color: rgb(36, 39, 41); letter-spacing: normal; orphans: 2; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); text-decoration-style: initial; text-decoration-color: initial;"><code style="margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: Consolas, Menlo, Monaco, &quot;Lucida Console&quot;, &quot;Liberation Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, monospace, sans-serif; font-size: 13px; vertical-align: baseline; box-sizing: inherit; background-color: rgb(239, 240, 241); white-space: pre-wrap;">LOWER_UP</code><span>&nbsp;</span>differs from<span>&nbsp;</span><code style="margin: 0px; padding: 1px 5px; border: 0px; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; font-family: Consolas, Menlo, Monaco, &quot;Lucida Console&quot;, &quot;Liberation Mono&quot;, &quot;DejaVu Sans Mono&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, monospace, sans-serif; font-size: 13px; vertical-align: baseline; box-sizing: inherit; background-color: rgb(239, 240, 241); white-space: pre-wrap;">UP</code>, which additionally requires the network interface to be enabled.</p>

<p>The string UP must be present, otherwise the interface is administratively down<br>
</p>


<pre>jeffs@jeffs-desktop:/home/jeffs/logbooks  (master) *  $ ip --statistics link show eno1<br>3: eno1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP mode DEFAULT group default qlen 1000<br>    link/ether 00:22:4d:7c:4d:d9 brd ff:ff:ff:ff:ff:ff<br>    RX: bytes  packets  errors  dropped overrun mcast   <br>    684108602  552228   0       0       0       939     <br>    TX: bytes  packets  errors  dropped carrier collsns <br>    38949950   317672   366     0       0       89186   <br>jeffs@jeffs-desktop:/home/jeffs/logbooks  (master) *  $ <br><br></pre>

<p>Note that the ip command confuses ethernet link with IP address</p>

<pre>jeffs@jeffs-desktop:/home/jeffs/logbooks  (master) *  $ ip --statistics addr show eno1<br>3: eno1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000<br>    link/ether 00:22:4d:7c:4d:d9 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.0.16/24 brd 192.168.0.255 scope global dynamic noprefixroute eno1<br>       valid_lft 65020sec preferred_lft 65020sec<br>    inet6 2602:61:7120:ef00:626c:4b12:cb68:ff3f/64 scope global noprefixroute <br>       valid_lft forever preferred_lft forever<br>    inet6 fd00::ae7f:4068:cb55:3152/64 scope global noprefixroute <br>       valid_lft forever preferred_lft forever<br>    inet6 fe80::59d:1419:ef30:64de/64 scope link noprefixroute <br>       valid_lft forever preferred_lft forever<br>    RX: bytes  packets  errors  dropped overrun mcast   <br>    684126132  552399   0       0       0       942     <br>    TX: bytes  packets  errors  dropped carrier collsns <br>    38973430   317840   366     0       0       89186   <br>jeffs@jeffs-desktop:/home/jeffs/logbooks  (master) *  $ <br><br></pre>

<pre>jeffs@jeffs-desktop:/home/jeffs/logbooks  (master) *  $ ip -6 --statistics addr show eno1<br>3: eno1: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 state UP qlen 1000<br>    inet6 2602:61:7120:ef00:626c:4b12:cb68:ff3f/64 scope global noprefixroute <br>       valid_lft forever preferred_lft forever<br>    inet6 fd00::ae7f:4068:cb55:3152/64 scope global noprefixroute <br>       valid_lft forever preferred_lft forever<br>    inet6 fe80::59d:1419:ef30:64de/64 scope link noprefixroute <br>       valid_lft forever preferred_lft forever<br><br>jeffs@jeffs-desktop:/home/jeffs/logbooks  (master) *  $ <br></pre>

<p>Look at how the LOWER_UP and&nbsp; flags change as the interface is administratively up'd and down'd.</p>

<pre><font color="#4E9A06">jeffs@jeffs-desktop:/home/jeffs/python/nbmdt </font> <font color="#06989A">(development)</font> <font color="#CC0000">* </font> $ ip link show dev enp3s0
2: enp3s0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether 00:10:18:cc:9c:77 brd ff:ff:ff:ff:ff:ff
<font color="#4E9A06">jeffs@jeffs-desktop:/home/jeffs/python/nbmdt </font> <font color="#06989A">(development)</font> <font color="#CC0000">* </font> $ sudo ip link set dev enp3s0 down
[sudo] password for jeffs: 
<font color="#4E9A06">jeffs@jeffs-desktop:/home/jeffs/python/nbmdt </font> <font color="#06989A">(development)</font> <font color="#CC0000">* </font> $ ip link show dev enp3s0
2: enp3s0: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether 00:10:18:cc:9c:77 brd ff:ff:ff:ff:ff:ff
<font color="#4E9A06">jeffs@jeffs-desktop:/home/jeffs/python/nbmdt </font> <font color="#06989A">(development)</font> <font color="#CC0000">* </font> $ sudo ip link set dev enp3s0 up
<font color="#4E9A06">jeffs@jeffs-desktop:/home/jeffs/python/nbmdt </font> <font color="#06989A">(development)</font> <font color="#CC0000">* </font> $ ip link show dev enp3s0
2: enp3s0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc mq state DOWN mode DEFAULT group default qlen 1000
    link/ether 00:10:18:cc:9c:77 brd ff:ff:ff:ff:ff:ff
<font color="#4E9A06">jeffs@jeffs-desktop:/home/jeffs/python/nbmdt </font> <font color="#06989A">(development)</font> <font color="#CC0000">* </font> $ 
</pre>

<p>If the NO-CARRIER string is present, then the NBMDT must report that the cable is not plugged in.<br>
</p>

<h3>linux wifi</h3>

<p><br>
</p>


<p><br>
</p>

<p><br>
</p>

<p><br>
</p>

<p><br>
</p>

<hr style="width: 100%; height: 2px;">
<h1><a name="mozTocId174413" class="mozTocH1"></a>Acronyms<a name="ARP"></a></h1>

<dl>

  <dt>A</dt>
  <dd>Add things to this list after here<br>
  </dd>
  <dt><a name="AP"></a>AP</dt>
  <dd>WiFi Access point<br>
  </dd>
</dl>


<dl>

<dt><a name="ARP"></a>ARP</dt>
</dl>

<dl>

  <dd>Address Resolution Protocol</dd>
  <dt><a name="DNS"></a>DNS</dt>
  <dd>Domain Name Service</dd>
  <dt><a name="IP"></a>IP</dt>
  <dd>Internet Protocol</dd>
  <dt><a name="IPv4"></a>IPv4</dt>
  <dd>Internet Protocol, version 4</dd>
  <dt><a name="IPv6"></a>IPv6</dt>
  <dd>Internet Protocol, version 6</dd>
  <dt><a name="NDP_"></a>NDP</dt>
  <dd>Neighbor Discovery Protocol</dd>
  <dt><a name="SCTP"></a>SCTP</dt>
  <dd><span style="color: rgb(255, 153, 0);">Something</span> Control Transmission Protocol<br>
  </dd>
  <dt><a name="TCP"></a>TCP</dt>
  <dd>Transmission Control Protocol</dd>
  <dt><a name="NDP"></a>NDP</dt>
  <dd>Network Discovery Protocol<br>
  </dd>
  <dt><a name="NTP"></a>NTP</dt>
  <dd>Network Time Protocol</dd>
  <dt><a name="UDP"></a>UDP</dt>
  <dd>User Datagram Protocol</dd>
  <dt><a name="WiFi"></a>WiFi</dt>
  <dd>Wireless<br>
  </dd>
</dl>

</body></html>